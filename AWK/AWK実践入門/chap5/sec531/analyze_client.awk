##=================================================================
## HTTPDログ解析
## クライアント別アクセス集計
## analyze_client.awk
##-----------------------------------------------------------------
## 引数のログファイルから、クライアント別のアクセス数の集計を行う
##=================================================================

##=================================================================
## 主処理
##=================================================================

BEGIN {
    FPAT="([^ ]+)|(\"[^\"]+\")|(\[[^\[]+[^\]]+\])"
}

{
    freq_of[$9]+=1
}

END {
    for ( i in freq_of ) {
        if ( ! freq_of[i] ) {
            freq_of[i] = 0
        }
        print i "," freq_of[i]
        total+= freq_of[i]
    }
    print "total " total
}

##=================================================================
## 関数定義
##=================================================================
